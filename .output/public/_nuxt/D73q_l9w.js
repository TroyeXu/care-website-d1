import{v as O,u as R,x as G,y as H,z as I,A as _,B as Q,c as J,o as K,w as o,a as t,b as L,d as W,e as s,l,j as X,C as d,D as Y,E as V,F as Z,f as ee,t as P,G as te,n as oe,H as se,_ as ae}from"./DLx3-ifv.js";import{u as le,F as j,l as ne,a as h,p as re}from"./CcHQG1vm.js";import{_ as ie}from"./BLeqURD3.js";import{_ as me}from"./CSiiy5fn.js";import"./Yqo6pqZJ.js";const de={class:"text-h5 text-primary q-mb-sm"},ue={class:"row q-gutter-md q-mb-md"},_e={class:"col"},ce={class:"row q-gutter-md q-mb-lg"},pe={class:"col"},fe={class:"row justify-between items-center q-mb-lg"},ge={class:"row q-gutter-md q-mb-md"},ve={class:"col"},xe={class:"q-pa-md bg-blue-1"},ye={class:"q-mb-xs"},be={class:"q-mb-xs"},we={class:"text-center"},qe={class:"text-body2 text-grey-6"},ke={class:"row q-gutter-sm q-mt-md"},Ve={class:"text-h6 text-negative"},he=O({__name:"login",setup(Ce){R("登入 - 護理服務平台","登入您的護理服務平台帳號，管理照護服務");const C=G(),c=H(),y=I(),b=_(!1),g=_(!1),$=_(!1),p=_(!1),v=_(!1),w=_(""),{setFieldValue:z}=le(),A={patient:{email:"zhiming.lin@email.com",password:"password123"},caregiver:{email:"meiling.chen@email.com",password:"password123"}},S=async i=>{const e=A[i];await se();try{z("email",e.email),z("password",e.password),c.notify({type:"info",message:`已填入${i==="patient"?"患者":"照護員"}測試帳號`,timeout:2e3})}catch(f){console.error("填入測試帳號失敗:",f)}},B=async i=>{b.value=!0;try{await y.login(i),c.notify({type:"positive",message:"登入成功！歡迎回來",icon:"check_circle",timeout:3e3}),y.currentUser?.role==="caregiver"?await C.push("/caregivers"):await C.push("/user/dashboard")}catch(e){console.error("登入失敗:",e),w.value=e.message||"登入過程發生錯誤，請稍後再試",v.value=!0,c.notify({type:"negative",message:w.value,icon:"error",timeout:5e3})}finally{b.value=!1}},D=async i=>{try{await y.resetPassword(i.email),c.notify({type:"positive",message:"密碼重設郵件已發送，請檢查您的信箱",icon:"email",timeout:5e3}),p.value=!1}catch(e){console.error("密碼重設失敗:",e),c.notify({type:"negative",message:e.message||"密碼重設失敗，請稍後再試",icon:"error",timeout:5e3})}};return(i,e)=>{const f=X,u=W,q=Y,U=Z,m=ee,N=ie,T=Q("router-link"),k=L,F=te,E=oe,M=me;return K(),J(M,{class:"q-pa-md flex flex-center bg-grey-1"},{default:o(()=>[t(k,{flat:"",bordered:"",class:"login-card",style:{"min-width":"400px","max-width":"450px",width:"100%"}},{default:o(()=>[t(u,{class:"text-center q-pb-none"},{default:o(()=>[s("div",de,[t(f,{name:"login",size:"md",class:"q-mr-sm"}),e[9]||(e[9]=l(" 登入帳號 ",-1))]),e[10]||(e[10]=s("div",{class:"text-grey-6 text-body2"},"歡迎回到護理服務平台",-1))]),_:1,__:[10]}),t(u,null,{default:o(()=>[t(d(j),{"validation-schema":d(ne),onSubmit:B},{default:o(({errors:n,isSubmitting:x})=>[s("div",ue,[s("div",_e,[t(d(h),{name:"email"},{default:o(({field:a,errorMessage:r})=>[t(q,V(a,{label:"電子郵件",type:"email",outlined:"",dense:"",error:!!r,"error-message":r,"prefix-icon":"email",placeholder:"請輸入您的電子郵件",autocomplete:"email"}),null,16,["error","error-message"])]),_:1})])]),s("div",ce,[s("div",pe,[t(d(h),{name:"password"},{default:o(({field:a,errorMessage:r})=>[t(q,V(a,{label:"密碼",type:g.value?"text":"password",outlined:"",dense:"",error:!!r,"error-message":r,"prefix-icon":"lock",placeholder:"請輸入您的密碼",autocomplete:"current-password"}),{append:o(()=>[t(f,{name:g.value?"visibility":"visibility_off",class:"cursor-pointer",onClick:e[0]||(e[0]=$e=>g.value=!g.value)},null,8,["name"])]),_:2},1040,["type","error","error-message"])]),_:1})])]),s("div",fe,[t(U,{modelValue:$.value,"onUpdate:modelValue":e[1]||(e[1]=a=>$.value=a),label:"記住我",color:"primary",size:"sm"},null,8,["modelValue"]),t(m,{flat:"","no-caps":"",color:"primary",size:"sm",onClick:e[2]||(e[2]=a=>p.value=!0)},{default:o(()=>e[11]||(e[11]=[l(" 忘記密碼？ ",-1)])),_:1,__:[11]})]),s("div",ge,[s("div",ve,[t(m,{type:"submit",color:"primary",size:"lg",class:"full-width",loading:x||b.value,disable:Object.keys(n).length>0,icon:"login"},{default:o(()=>[l(P(x?"登入中...":"登入"),1)]),_:2},1032,["loading","disable"])])]),t(N,{icon:"info",label:"測試帳號資訊",class:"q-mb-md","header-class":"text-grey-6 text-caption"},{default:o(()=>[s("div",xe,[e[16]||(e[16]=s("div",{class:"text-caption text-grey-7 q-mb-sm"}," 您可以使用以下測試帳號進行登入： ",-1)),s("div",ye,[e[13]||(e[13]=s("strong",null,"患者帳號：",-1)),t(m,{flat:"",dense:"",size:"sm",color:"primary",onClick:e[3]||(e[3]=a=>S("patient"))},{default:o(()=>e[12]||(e[12]=[l(" zhiming.lin@email.com ",-1)])),_:1,__:[12]})]),s("div",be,[e[15]||(e[15]=s("strong",null,"照護員帳號：",-1)),t(m,{flat:"",dense:"",size:"sm",color:"primary",onClick:e[4]||(e[4]=a=>S("caregiver"))},{default:o(()=>e[14]||(e[14]=[l(" meiling.chen@email.com ",-1)])),_:1,__:[14]})]),e[17]||(e[17]=s("div",{class:"text-caption text-grey-6"},"密碼：password123",-1))])]),_:1}),s("div",we,[s("div",qe,[e[19]||(e[19]=l(" 還沒有帳號？ ",-1)),t(T,{to:"/auth/register",class:"text-primary text-decoration-none"},{default:o(()=>e[18]||(e[18]=[l(" 立即註冊 ",-1)])),_:1,__:[18]})])])]),_:1},8,["validation-schema"])]),_:1})]),_:1}),t(F,{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=n=>p.value=n)},{default:o(()=>[t(k,{style:{"min-width":"350px"}},{default:o(()=>[t(u,null,{default:o(()=>e[20]||(e[20]=[s("div",{class:"text-h6"},"重設密碼",-1)])),_:1,__:[20]}),t(u,{class:"q-pt-none"},{default:o(()=>[t(d(j),{"validation-schema":d(re),onSubmit:D},{default:o(({errors:n,isSubmitting:x})=>[t(d(h),{name:"email"},{default:o(({field:a,errorMessage:r})=>[t(q,V(a,{label:"電子郵件",type:"email",outlined:"",dense:"",error:!!r,"error-message":r,placeholder:"請輸入您的電子郵件"}),null,16,["error","error-message"])]),_:1}),s("div",ke,[t(m,{flat:"",label:"取消",onClick:e[5]||(e[5]=a=>p.value=!1)}),t(m,{type:"submit",color:"primary",label:"發送重設郵件",loading:x,disable:Object.keys(n).length>0},null,8,["loading","disable"])])]),_:1},8,["validation-schema"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(F,{modelValue:v.value,"onUpdate:modelValue":e[8]||(e[8]=n=>v.value=n)},{default:o(()=>[t(k,null,{default:o(()=>[t(u,null,{default:o(()=>[s("div",Ve,[t(f,{name:"error",class:"q-mr-sm"}),e[21]||(e[21]=l(" 登入失敗 ",-1))])]),_:1}),t(u,null,{default:o(()=>[l(P(w.value),1)]),_:1}),t(E,{align:"right"},{default:o(()=>[t(m,{flat:"",color:"primary",onClick:e[7]||(e[7]=n=>v.value=!1)},{default:o(()=>e[22]||(e[22]=[l(" 確定 ",-1)])),_:1,__:[22]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Ae=ae(he,[["__scopeId","data-v-173742c4"]]);export{Ae as default};
