import{C as j}from"./C-s1-Qrp.js";import{v as F,u as I,z as V,A as v,a1 as q,R as h,J as o,o as a,C as r,e as s,t as i,al as l,K as b,L as T,c as J,ap as $,ae as K,_ as P}from"./DLx3-ifv.js";import{u as W}from"./Bs_-0E3x.js";const G={class:"dashboard"},H={key:0,class:"dashboard-content"},O={class:"welcome-section"},Q={class:"user-info"},X=["src","alt"],Y={class:"user-details"},Z={class:"user-role"},x={class:"user-stats"},ss={class:"stat-item"},ts={class:"stat-number"},es={class:"stat-item"},ns={class:"stat-number"},as={class:"stat-item"},os={class:"stat-number"},is={class:"quick-actions"},rs={class:"action-grid"},ls={class:"recommendations-section"},ds={key:0,class:"caregivers-grid"},cs={key:1,class:"empty-state"},us={class:"upcoming-section"},vs={key:0,class:"bookings-list"},gs={class:"booking-info"},ps={class:"booking-caregiver"},ms={class:"booking-details"},ks={class:"booking-date"},_s={class:"booking-time"},hs={class:"booking-type"},ys={class:"booking-actions"},bs=["onClick"],Ts=["onClick"],fs={key:1,class:"empty-state"},Cs={class:"history-section"},ws={key:0,class:"history-list"},Bs={class:"history-info"},Ds={class:"history-caregiver"},$s={class:"history-date"},Ss={class:"history-cost"},Us={key:1,class:"empty-state"},As={key:1,class:"login-prompt"},Rs={class:"login-card"},Ls={class:"login-actions"},Ns=F({__name:"dashboard",setup(zs){I("å€‹äººå„€è¡¨æ¿ - è­·ç†æœå‹™å¹³å°","å¿«é€ŸæŸ¥çœ‹æŽ¨è–¦çœ‹è­·åŠå³å°‡åˆ°ä¾†çš„æŽ’ç¨‹");const d=V(),g=W(),S=v(null),p=v([]),m=v([]),k=v([]),f=v([]);q(async()=>{await C()});const C=async()=>{try{if(d.currentUser){S.value=await g.getDashboardStats(d.currentUser.id);const e=await g.getFeaturedCaregivers();p.value=e.data||e,f.value=p.value;const u=await g.getBookingsByUser(d.currentUser.id)||[],n=new Date;m.value=u.filter(c=>new Date(c.start_date)>=n&&["confirmed","pending"].includes(c.status)).sort((c,_)=>new Date(c.start_date).getTime()-new Date(_.start_date).getTime()).slice(0,3),k.value=u.sort((c,_)=>new Date(_.created_at).getTime()-new Date(c.created_at).getTime())}}catch(e){console.error("è¼‰å…¥å„€è¡¨æ¿è³‡æ–™å¤±æ•—:",e)}},U=h(()=>{switch(d.currentUser?.role){case"patient":return"ç…§è­·éœ€æ±‚è€…";case"caregiver":return"çœ‹è­·äººå“¡";case"admin":return"ç®¡ç†å“¡";default:return"ç”¨æˆ¶"}}),y=h(()=>[...m.value,...k.value]),A=h(()=>y.value.filter(e=>e.status==="completed")),R=h(()=>y.value.filter(e=>e.status==="pending")),L=e=>{const t=e.target;t.src="/images/default-avatar.jpg"},w=e=>f.value.find(u=>u.id===e)?.name||"æœªçŸ¥çœ‹è­·å¸«",B=e=>new Date(e).toLocaleDateString("zh-TW",{year:"numeric",month:"short",day:"numeric"}),N=e=>e==="hourly"?"æŒ‰æ™‚è¨ˆè²»":"åŒ…ç­åˆ¶",D=e=>({pending:"å¾…ç¢ºèª",confirmed:"å·²ç¢ºèª",in_progress:"é€²è¡Œä¸­",completed:"å·²å®Œæˆ",cancelled:"å·²å–æ¶ˆ"})[e]||e,z=e=>{l(`/caregivers/${e.id}?action=book`)},E=e=>{l(`/bookings/${e.id}`)},M=async e=>{if(confirm("ç¢ºå®šè¦å–æ¶ˆé€™å€‹é ç´„å—Žï¼Ÿ"))try{await g.cancelBooking(e.id),alert("é ç´„å·²å–æ¶ˆ"),await C()}catch{alert("å–æ¶ˆé ç´„æ™‚ç™¼ç”ŸéŒ¯èª¤")}};return(e,t)=>{const u=j;return a(),o("div",G,[r(d).isAuthenticated?(a(),o("div",H,[s("div",O,[s("div",Q,[s("img",{src:r(d).currentUser?.avatar||"/images/default-avatar.jpg",alt:r(d).currentUser?.name,class:"user-avatar",onError:L},null,40,X),s("div",Y,[s("h1",null,"æ­¡è¿Žå›žä¾†ï¼Œ"+i(r(d).currentUser?.name),1),s("p",Z,i(U.value)+" | "+i(r(d).currentUser?.email),1),s("div",x,[s("div",ss,[s("span",ts,i(y.value.length),1),t[9]||(t[9]=s("span",{class:"stat-label"},"ç¸½é ç´„æ•¸",-1))]),s("div",es,[s("span",ns,i(A.value.length),1),t[10]||(t[10]=s("span",{class:"stat-label"},"å·²å®Œæˆ",-1))]),s("div",as,[s("span",os,i(R.value.length),1),t[11]||(t[11]=s("span",{class:"stat-label"},"å¾…ç¢ºèª",-1))])])])])]),s("div",is,[t[16]||(t[16]=s("h2",null,"å¿«é€Ÿæ“ä½œ",-1)),s("div",rs,[s("button",{class:"action-card",onClick:t[0]||(t[0]=n=>("navigateTo"in e?e.navigateTo:r(l))("/caregivers/search"))},t[12]||(t[12]=[s("div",{class:"action-icon"},"ðŸ”",-1),s("div",{class:"action-text"},[s("h3",null,"æœå°‹çœ‹è­·"),s("p",null,"æ‰¾åˆ°æœ€é©åˆçš„çœ‹è­·å¸«")],-1)])),s("button",{class:"action-card",onClick:t[1]||(t[1]=n=>("navigateTo"in e?e.navigateTo:r(l))("/booking/calculator"))},t[13]||(t[13]=[s("div",{class:"action-icon"},"ðŸ’°",-1),s("div",{class:"action-text"},[s("h3",null,"è²»ç”¨è¨ˆç®—"),s("p",null,"ä¼°ç®—ç…§è­·æœå‹™è²»ç”¨")],-1)])),s("button",{class:"action-card",onClick:t[2]||(t[2]=n=>("navigateTo"in e?e.navigateTo:r(l))("/booking/match"))},t[14]||(t[14]=[s("div",{class:"action-icon"},"ðŸŽ¯",-1),s("div",{class:"action-text"},[s("h3",null,"æ™ºèƒ½åª’åˆ"),s("p",null,"AI æŽ¨è–¦æœ€ä½³çœ‹è­·")],-1)])),s("button",{class:"action-card",onClick:t[3]||(t[3]=n=>("navigateTo"in e?e.navigateTo:r(l))("/booking/schedule"))},t[15]||(t[15]=[s("div",{class:"action-icon"},"ðŸ“…",-1),s("div",{class:"action-text"},[s("h3",null,"æŽ’ç¨‹ç®¡ç†"),s("p",null,"æŸ¥çœ‹é ç´„æ™‚ç¨‹")],-1)]))])]),s("div",ls,[t[18]||(t[18]=s("h2",null,"ç‚ºæ‚¨æŽ¨è–¦",-1)),p.value.length>0?(a(),o("div",ds,[(a(!0),o(b,null,T(p.value,n=>(a(),J(u,{key:n.id,caregiver:n,onBook:z},null,8,["caregiver"]))),128))])):(a(),o("div",cs,[t[17]||(t[17]=s("p",null,"æš«ç„¡æŽ¨è–¦çœ‹è­·å¸«ï¼Œè«‹å…ˆå®Œå–„æ‚¨çš„å€‹äººè³‡æ–™å’Œåå¥½è¨­å®š",-1)),s("button",{class:"btn-primary",onClick:t[4]||(t[4]=n=>("navigateTo"in e?e.navigateTo:r(l))("/profile"))}," å®Œå–„è³‡æ–™ ")]))]),s("div",us,[t[20]||(t[20]=s("h2",null,"å³å°‡åˆ°ä¾†çš„é ç´„",-1)),m.value.length>0?(a(),o("div",vs,[(a(!0),o(b,null,T(m.value,n=>(a(),o("div",{key:n.id,class:"booking-card"},[s("div",gs,[s("div",ps,[s("strong",null,i(w(n.caregiver_id)),1)]),s("div",ms,[s("span",ks,i(B(n.start_date)),1),s("span",_s,i(n.start_time),1),s("span",hs,i(N(n.service_type)),1)]),s("div",{class:$(["booking-status",`status-${n.status}`])},i(D(n.status)),3)]),s("div",ys,[s("button",{class:"btn-secondary btn-sm",onClick:c=>E(n)}," æŸ¥çœ‹è©³æƒ… ",8,bs),n.status==="pending"?(a(),o("button",{key:0,class:"btn-danger btn-sm",onClick:c=>M(n)}," å–æ¶ˆé ç´„ ",8,Ts)):K("",!0)])]))),128))])):(a(),o("div",fs,[t[19]||(t[19]=s("p",null,"ç›®å‰æ²’æœ‰å³å°‡åˆ°ä¾†çš„é ç´„",-1)),s("button",{class:"btn-primary",onClick:t[5]||(t[5]=n=>("navigateTo"in e?e.navigateTo:r(l))("/caregivers/search"))}," ç«‹å³é ç´„ ")]))]),s("div",Cs,[t[22]||(t[22]=s("h2",null,"æœå‹™æ­·å²",-1)),k.value.length>0?(a(),o("div",ws,[(a(!0),o(b,null,T(k.value.slice(0,5),n=>(a(),o("div",{key:n.id,class:"history-item"},[s("div",Bs,[s("span",Ds,i(w(n.caregiver_id)),1),s("span",$s,i(B(n.start_date)),1),s("span",{class:$(["history-status",`status-${n.status}`])},i(D(n.status)),3)]),s("div",Ss," NT$ "+i(n.total_cost.toLocaleString()),1)]))),128)),s("button",{class:"btn-link",onClick:t[6]||(t[6]=n=>("navigateTo"in e?e.navigateTo:r(l))("/bookings"))}," æŸ¥çœ‹å®Œæ•´æ­·å²è¨˜éŒ„ ")])):(a(),o("div",Us,t[21]||(t[21]=[s("p",null,"å°šç„¡æœå‹™æ­·å²è¨˜éŒ„",-1)])))])])):(a(),o("div",As,[s("div",Rs,[t[23]||(t[23]=s("h2",null,"è«‹å…ˆç™»å…¥",-1)),t[24]||(t[24]=s("p",null,"ç™»å…¥å¾Œå³å¯æŸ¥çœ‹å€‹äººå„€è¡¨æ¿ã€é ç´„è¨˜éŒ„å’ŒæŽ¨è–¦æœå‹™",-1)),s("div",Ls,[s("button",{class:"btn-primary",onClick:t[7]||(t[7]=n=>("navigateTo"in e?e.navigateTo:r(l))("/auth/login"))}," ç«‹å³ç™»å…¥ "),s("button",{class:"btn-secondary",onClick:t[8]||(t[8]=n=>("navigateTo"in e?e.navigateTo:r(l))("/auth/register"))}," è¨»å†Šå¸³è™Ÿ ")])])]))])}}}),Fs=P(Ns,[["__scopeId","data-v-bd446c8a"]]);export{Fs as default};
