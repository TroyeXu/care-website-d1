import{c as e,at as l,au as t,av as o,aw as n,g as a,E as i,an as u,u as r,i as s,b as c,ao as d,L as p,ap as v,l as f,aq as m,ax as S,ay as g,az as h,ac as y,aA as V,H as w,aB as b,aC as C,r as x,aD as I,a6 as k,aE as O,aF as z,aG as T,aH as M,aI as P,aJ as A,aK as F,_ as E,aL as q,aM as B,C as D,q as H,p as R,o as _,h as L}from"../build/server.mjs";import{_ as K}from"./QChip.mjs";import{v as $,a as N,f as j,b as U,c as W,p as X,d as Q,r as Y,g as G,s as J}from"./position-engine.mjs";import{n as Z,e as ee,az as le,aG as te,o as oe,aF as ne,bc as ae,k as ie,l as ue,aC as re,aK as se,bf as ce}from"../nitro/nitro.mjs";const de=e({name:"QField",inheritAttrs:!1,props:{...t,tag:{type:String,default:"label"}},emits:l,setup:()=>o(n({tagProp:!0}))}),pe=e({name:"QMenu",inheritAttrs:!1,props:{...j,...s,...r,...u,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:N},self:{type:String,validator:N},offset:{type:Array,validator:$},scrollTarget:i,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...a,"click","escapeKey"],setup(e,{slots:l,emit:t,attrs:o}){let n,a,i,u=null;const r=Z(),{proxy:s}=r,{$q:I}=s,k=ee(null),O=ee(!1),z=le((()=>!0!==e.persistent&&!0!==e.noRouteDismiss)),T=c(e,I),{registerTick:M,removeTick:P}=d(),{registerTimeout:A}=p();v(e);const{localScrollTarget:F,changeScrollEvent:E,unconfigureScrollTarget:q}=U(e,configureScrollTarget),{anchorEl:B,canShow:D}=W({showing:O}),{hide:H}=f({showing:O,canShow:D,handleShow:function(l){if(u=!1===e.noRefocus?document.activeElement:null,h(onFocusout),R(),configureScrollTarget(),n=void 0,void 0!==l&&(e.touchPosition||e.contextMenu)){const e=y(l);if(void 0!==e.left){const{top:l,left:t}=B.value.getBoundingClientRect();n={left:e.left-t,top:e.top-l}}}void 0===a&&(a=te((()=>I.screen.width+"|"+I.screen.height+"|"+e.self+"|"+e.anchor+"|"+I.lang.rtl),updatePosition));!0!==e.noFocus&&document.activeElement.blur();M((()=>{updatePosition(),!0!==e.noFocus&&focus()})),A((()=>{!0===I.platform.is.ios&&(i=e.autoClose,k.value.click()),updatePosition(),R(!0),t("show",l)}),e.transitionDuration)},handleHide:function(l){P(),_(),anchorCleanup(!0),null===u||void 0!==l&&!0===l.qClickOutside||(((0===l?.type.indexOf("key")?u.closest('[tabindex]:not([tabindex^="-"])'):void 0)||u).focus(),u=null);A((()=>{_(!0),t("hide",l)}),e.transitionDuration)},hideOnRouteChange:z,processOnMount:!0}),{showPortal:R,hidePortal:_,renderPortal:L}=m(),K={anchorEl:B,innerRef:k,onClickOutside(l){if(!0!==e.persistent&&!0===O.value)return H(l),("touchstart"===l.type||l.target.classList.contains("q-dialog__backdrop"))&&x(l),!0}},$=le((()=>X(e.anchor||(!0===e.cover?"center middle":"bottom start"),I.lang.rtl))),N=le((()=>!0===e.cover?$.value:X(e.self||"top start",I.lang.rtl)));le((()=>(!0===e.square?" q-menu--square":"")+(!0===T.value?" q-menu--dark q-dark":""))),le((()=>!0===e.autoClose?{onClick:onAutoClose}:{}));const j=le((()=>!0===O.value&&!0!==e.persistent));function focus(){C((()=>{let e=k.value;e&&!0!==e.contains(document.activeElement)&&(e=e.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||e.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||e.querySelector("[autofocus], [data-autofocus]")||e,e.focus({preventScroll:!0}))}))}function anchorCleanup(e){n=void 0,void 0!==a&&(a(),a=void 0),!0!==e&&!0!==O.value||(V(onFocusout),q(),Y(K),g(onEscapeKey)),!0!==e&&(u=null)}function configureScrollTarget(){null===B.value&&void 0===e.scrollTarget||(F.value=w(B.value,e.scrollTarget),E(F.value,updatePosition))}function onAutoClose(e){!0!==i?(G(s,e),t("click",e)):i=!1}function onFocusout(l){!0===j.value&&!0!==e.noFocus&&!0!==b(k.value,l.target)&&focus()}function onEscapeKey(l){!0!==e.noEscDismiss&&(t("escapeKey"),H(l))}function updatePosition(){J({targetEl:k.value,offset:e.offset,anchorEl:B.value,anchorOrigin:$.value,selfOrigin:N.value,absoluteOffset:n,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}return te(j,(e=>{!0===e?(S(onEscapeKey),Q(K)):(g(onEscapeKey),Y(K))})),oe(anchorCleanup),Object.assign(s,{focus:focus,updatePosition:updatePosition}),L}}),ve=1e3,fe=["start","center","end","start-force","center-force","end-force"],me=Array.prototype.filter;function sumFn(e,l){return e+l}function getScrollDetails(e,l,t,o,n,a,i,u){const r=e===window?document.scrollingElement||document.documentElement:e,s=!0===n?"offsetWidth":"offsetHeight",c={scrollStart:0,scrollViewSize:-i-u,scrollMaxSize:0,offsetStart:-i,offsetEnd:-u};if(!0===n?(e===window?(c.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,c.scrollViewSize+=document.documentElement.clientWidth):(c.scrollStart=r.scrollLeft,c.scrollViewSize+=r.clientWidth),c.scrollMaxSize=r.scrollWidth,!0===a&&(c.scrollStart=0-c.scrollStart)):(e===window?(c.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,c.scrollViewSize+=document.documentElement.clientHeight):(c.scrollStart=r.scrollTop,c.scrollViewSize+=r.clientHeight),c.scrollMaxSize=r.scrollHeight),null!==t)for(let e=t.previousElementSibling;null!==e;e=e.previousElementSibling)!1===e.classList.contains("q-virtual-scroll--skip")&&(c.offsetStart+=e[s]);if(null!==o)for(let e=o.nextElementSibling;null!==e;e=e.nextElementSibling)!1===e.classList.contains("q-virtual-scroll--skip")&&(c.offsetEnd+=e[s]);if(l!==e){const t=r.getBoundingClientRect(),o=l.getBoundingClientRect();!0===n?(c.offsetStart+=o.left-t.left,c.offsetEnd-=o.width):(c.offsetStart+=o.top-t.top,c.offsetEnd-=o.height),e!==window&&(c.offsetStart+=c.scrollStart),c.offsetEnd+=c.scrollMaxSize-c.offsetStart}return c}function setScroll(e,l,t,o){"end"===l&&(l=(e===window?document.body:e)[!0===t?"scrollWidth":"scrollHeight"]),e===window?!0===t?(!0===o&&(l=0-l),window.scrollTo(l,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,l):!0===t?(!0===o&&(l=0-l),e.scrollLeft=l):e.scrollTop=l}function sumSize(e,l,t,o){if(t>=o)return 0;const n=l.length,a=Math.floor(t/ve),i=Math.floor((o-1)/ve)+1;let u=e.slice(a,i).reduce(sumFn,0);return t%ve!==0&&(u-=l.slice(a*ve,t).reduce(sumFn,0)),o%ve!==0&&o!==n&&(u-=l.slice(o,i*ve).reduce(sumFn,0)),u}const Se={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...{virtualScrollSliceSize:{type:[Number,String],default:10},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]}};const validateNewValueMode=e=>["add","add-unique","toggle"].includes(e),ge=Object.keys(t);function getPropValueFn(e,l){if("function"==typeof e)return e;const t=void 0!==e?e:l;return e=>null!==e&&"object"==typeof e&&t in e?e[t]:e}const he=e({name:"QSelect",inheritAttrs:!1,props:{...Se,...k,...t,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],popupNoRouteDismiss:Boolean,useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:validateNewValueMode},mapOptions:Boolean,emitValue:Boolean,disableTabSelection:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:{},transitionHide:{},transitionDuration:{},behavior:{type:String,validator:e=>["default","menu","dialog"].includes(e),default:"default"},virtualScrollItemSize:Se.virtualScrollItemSize.type,onNewValue:Function,onFilter:Function},emits:[...l,"add","remove","inputValue","keyup","keypress","keydown","popupShow","popupHide","filterAbort"],setup(e,{slots:l,emit:t}){const{proxy:a}=Z(),{$q:i}=a,u=ee(!1),r=ee(!1),s=ee(-1),c=ee(""),d=ee(!1),p=ee(!1);let v,f,m,S,g,h,y,V=null,w=null,b=null;const C=ee(null),k=ee(null),$=ee(null),N=ee(null),j=ee(null),U=O(e),W=T(onInput),X=le((()=>Array.isArray(e.options)?e.options.length:0)),Q=le((()=>void 0===e.virtualScrollItemSize?!0===e.optionsDense?24:48:e.virtualScrollItemSize)),{virtualScrollSliceRange:Y,virtualScrollSliceSizeComputed:G,localResetVirtualScroll:J,padVirtualScroll:Se,onVirtualScrollEvt:he,scrollTo:ye,setVirtualScrollSize:Ve}=function({virtualScrollLength:e,getVirtualScrollTarget:l,getVirtualScrollEl:t,virtualScrollItemSizeComputed:o}){const n=Z(),{props:a,emit:i,proxy:u}=n,{$q:r}=u;let s,c,d,p,v=[];const f=ee(0),m=ee(0),S=ee({}),g=ee(null),h=ee(null),y=ee(null),V=ee({from:0,to:0}),w=le((()=>void 0!==a.tableColspan?a.tableColspan:100));void 0===o&&(o=le((()=>a.virtualScrollItemSize)));const b=le((()=>o.value+";"+a.virtualScrollHorizontal)),C=le((()=>b.value+";"+a.virtualScrollSliceRatioBefore+";"+a.virtualScrollSliceRatioAfter));function reset(){localResetVirtualScroll(c,!0)}function refresh(e){localResetVirtualScroll(void 0===e?c:e)}function scrollTo(o,n){const i=l();if(null==i||8===i.nodeType)return;const u=getScrollDetails(i,t(),g.value,h.value,a.virtualScrollHorizontal,r.lang.rtl,a.virtualScrollStickySizeStart,a.virtualScrollStickySizeEnd);d!==u.scrollViewSize&&setVirtualScrollSize(u.scrollViewSize),setVirtualScrollSliceRange(i,u,Math.min(e.value-1,Math.max(0,parseInt(o,10)||0)),0,-1!==fe.indexOf(n)?n:-1!==c&&o>c?"end":"start")}function setVirtualScrollSliceRange(l,t,o,n,i){const u="string"==typeof i&&-1!==i.indexOf("-force"),c=!0===u?i.replace("-force",""):i,d=void 0!==c?c:"start";let g=Math.max(0,o-S.value[d]),h=g+S.value.total;h>e.value&&(h=e.value,g=Math.max(0,h-S.value.total)),s=t.scrollStart;const w=g!==V.value.from||h!==V.value.to;if(!1===w&&void 0===c)return void emitScroll(o);const{activeElement:b}=document,C=y.value;!0===w&&null!==C&&C!==b&&!0===C.contains(b)&&(C.addEventListener("focusout",onBlurRefocusFn),setTimeout((()=>{C?.removeEventListener("focusout",onBlurRefocusFn)})));const x=void 0!==c?p.slice(g,o).reduce(sumFn,0):0;if(!0===w){const l=h>=V.value.from&&g<=V.value.to?V.value.to:h;V.value={from:g,to:l},f.value=sumSize(v,p,0,g),m.value=sumSize(v,p,h,e.value),requestAnimationFrame((()=>{V.value.to!==h&&s===t.scrollStart&&(V.value={from:V.value.from,to:h},m.value=sumSize(v,p,h,e.value))}))}requestAnimationFrame((()=>{if(s!==t.scrollStart)return;!0===w&&updateVirtualScrollSizes(g);const e=p.slice(g,o).reduce(sumFn,0),i=e+t.offsetStart+f.value,d=i+p[o];let v=i+n;if(void 0!==c){const l=e-x,n=t.scrollStart+l;v=!0!==u&&n<i&&d<n+t.scrollViewSize?n:"end"===c?d-t.scrollViewSize:i-("start"===c?0:Math.round((t.scrollViewSize-p[o])/2))}s=v,setScroll(l,v,a.virtualScrollHorizontal,r.lang.rtl),emitScroll(o)}))}function updateVirtualScrollSizes(e){const l=y.value;if(l){const t=me.call(l.children,(e=>e.classList&&!1===e.classList.contains("q-virtual-scroll--skip"))),o=t.length,n=!0===a.virtualScrollHorizontal?e=>e.getBoundingClientRect().width:e=>e.offsetHeight;let i,u,r=e;for(let e=0;e<o;){for(i=n(t[e]),e++;e<o&&!0===t[e].classList.contains("q-virtual-scroll--with-prev");)i+=n(t[e]),e++;u=i-p[r],0!==u&&(p[r]+=u,v[Math.floor(r/ve)]+=u),r++}}}function onBlurRefocusFn(){y.value?.focus()}function localResetVirtualScroll(l,t){const n=1*o.value;!0!==t&&!1!==Array.isArray(p)||(p=[]);const a=p.length;p.length=e.value;for(let l=e.value-1;l>=a;l--)p[l]=n;const i=Math.floor((e.value-1)/ve);v=[];for(let l=0;l<=i;l++){let t=0;const o=Math.min((l+1)*ve,e.value);for(let e=l*ve;e<o;e++)t+=p[e];v.push(t)}c=-1,s=void 0,f.value=sumSize(v,p,0,V.value.from),m.value=sumSize(v,p,V.value.to,e.value),l>=0?(updateVirtualScrollSizes(V.value.from),ne((()=>{scrollTo(l)}))):x()}function setVirtualScrollSize(e){d=e;const l=parseFloat(a.virtualScrollSliceRatioBefore)||0,t=1+l+(parseFloat(a.virtualScrollSliceRatioAfter)||0),n=void 0===e||e<=0?1:Math.ceil(e/o.value),i=Math.max(1,n,Math.ceil((a.virtualScrollSliceSize>0?a.virtualScrollSliceSize:10)/t));S.value={total:Math.ceil(i*t),start:Math.ceil(i*l),center:Math.ceil(i*(.5+l)),end:Math.ceil(i*(1+l)),view:n}}function emitScroll(e){c!==e&&(void 0!==a.onVirtualScroll&&i("virtualScroll",{index:e,from:V.value.from,to:V.value.to-1,direction:e<c?"decrease":"increase",ref:u}),c=e)}te(C,(()=>{setVirtualScrollSize()})),te(b,reset),setVirtualScrollSize();const x=I((function(){const o=l();if(null==o||8===o.nodeType)return;const n=getScrollDetails(o,t(),g.value,h.value,a.virtualScrollHorizontal,r.lang.rtl,a.virtualScrollStickySizeStart,a.virtualScrollStickySizeEnd),i=e.value-1,u=n.scrollMaxSize-n.offsetStart-n.offsetEnd-m.value;if(s===n.scrollStart)return;if(n.scrollMaxSize<=0)return void setVirtualScrollSliceRange(o,n,0,0);d!==n.scrollViewSize&&setVirtualScrollSize(n.scrollViewSize),updateVirtualScrollSizes(V.value.from);const c=Math.floor(n.scrollMaxSize-Math.max(n.scrollViewSize,n.offsetEnd)-Math.min(p[i],n.scrollViewSize/2));if(c>0&&Math.ceil(n.scrollStart)>=c)return void setVirtualScrollSliceRange(o,n,i,n.scrollMaxSize-n.offsetEnd-v.reduce(sumFn,0));let S=0,y=n.scrollStart-n.offsetStart,w=y;if(y<=u&&y+n.scrollViewSize>=f.value)y-=f.value,S=V.value.from,w=y;else for(let e=0;y>=v[e]&&S<i;e++)y-=v[e],S+=ve;for(;y>0&&S<i;)y-=p[S],y>-n.scrollViewSize?(S++,w=y):w=p[S]+y;setVirtualScrollSliceRange(o,n,S,w)}),!0===r.platform.is.ios?120:35);ae((()=>{setVirtualScrollSize()}));let k=!1;return ie((()=>{k=!0})),ue((()=>{if(!0!==k)return;const e=l();void 0!==s&&null!=e&&8!==e.nodeType?setScroll(e,s,a.virtualScrollHorizontal,r.lang.rtl):scrollTo(c)})),Object.assign(u,{scrollTo:scrollTo,reset:reset,refresh:refresh}),{virtualScrollSliceRange:V,virtualScrollSliceSizeComputed:S,setVirtualScrollSize:setVirtualScrollSize,onVirtualScrollEvt:x,localResetVirtualScroll:localResetVirtualScroll,padVirtualScroll:function(e,l){const t=!0===a.virtualScrollHorizontal?"width":"height",n={["--q-virtual-scroll-item-"+t]:o.value+"px"};return["tbody"===e?re(e,{class:"q-virtual-scroll__padding",key:"before",ref:g},[re("tr",[re("td",{style:{[t]:`${f.value}px`,...n},colspan:w.value})])]):re(e,{class:"q-virtual-scroll__padding",key:"before",ref:g,style:{[t]:`${f.value}px`,...n}}),re(e,{class:"q-virtual-scroll__content",key:"content",ref:y,tabindex:-1},l.flat()),"tbody"===e?re(e,{class:"q-virtual-scroll__padding",key:"after",ref:h},[re("tr",[re("td",{style:{[t]:`${m.value}px`,...n},colspan:w.value})])]):re(e,{class:"q-virtual-scroll__padding",key:"after",ref:h,style:{[t]:`${m.value}px`,...n}})]},scrollTo:scrollTo,reset:reset,refresh:refresh}}({virtualScrollLength:X,getVirtualScrollTarget:function(){return getVirtualScrollEl()},getVirtualScrollEl:getVirtualScrollEl,virtualScrollItemSizeComputed:Q}),we=n(),be=le((()=>{const l=!0===e.mapOptions&&!0!==e.multiple,t=void 0===e.modelValue||null===e.modelValue&&!0!==l?[]:!0===e.multiple&&Array.isArray(e.modelValue)?e.modelValue:[e.modelValue];if(!0===e.mapOptions&&!0===Array.isArray(e.options)){const o=!0===e.mapOptions&&void 0!==v?v:[],n=t.map((l=>function(l,t){const fn=e=>M(Le.value(e),l);return e.options.find(fn)||t.find(fn)||l}(l,o)));return null===e.modelValue&&!0===l?n.filter((e=>null!==e)):n}return t})),Ce=le((()=>{const l={};return ge.forEach((t=>{const o=e[t];void 0!==o&&(l[t]=o)})),l})),xe=le((()=>null===e.optionsDark?we.isDark.value:e.optionsDark)),Ie=le((()=>z(be.value))),ke=le((()=>{let l="q-field__input q-placeholder col";return!0===e.hideSelected||0===be.value.length?[l,e.inputClass]:(l+=" q-field__input--padding",void 0===e.inputClass?l:[l,e.inputClass])})),Oe=le((()=>(!0===e.virtualScrollHorizontal?"q-virtual-scroll--horizontal":"")+(e.popupContentClass?" "+e.popupContentClass:""))),ze=le((()=>0===X.value)),Te=le((()=>be.value.map((e=>Ke.value(e))).join(", "))),Me=le((()=>void 0!==e.displayValue?e.displayValue:Te.value)),Pe=le((()=>!0===e.optionsHtml?()=>!0:e=>!0===e?.html)),Ae=le((()=>!0===e.displayValueHtml||void 0===e.displayValue&&(!0===e.optionsHtml||be.value.some(Pe.value)))),Fe=le((()=>!0===we.focused.value?e.tabindex:-1)),Ee=le((()=>{const l={tabindex:e.tabindex,role:"combobox","aria-label":e.label,"aria-readonly":!0===e.readonly?"true":"false","aria-autocomplete":!0===e.useInput?"list":"none","aria-expanded":!0===u.value?"true":"false","aria-controls":`${we.targetUid.value}_lb`};return s.value>=0&&(l["aria-activedescendant"]=`${we.targetUid.value}_${s.value}`),l})),qe=le((()=>({id:`${we.targetUid.value}_lb`,role:"listbox","aria-multiselectable":!0===e.multiple?"true":"false"}))),Be=le((()=>be.value.map(((e,l)=>({index:l,opt:e,html:Pe.value(e),selected:!0,removeAtIndex:removeAtIndexAndFocus,toggleOption:toggleOption,tabindex:Fe.value}))))),De=le((()=>{if(0===X.value)return[];const{from:l,to:t}=Y.value;return e.options.slice(l,t).map(((t,o)=>{const n=!0===$e.value(t),a=!0===isOptionSelected(t),r=l+o,c={clickable:!0,active:a,activeClass:_e.value,manualFocus:!0,focused:!1,disable:n,tabindex:-1,dense:e.optionsDense,dark:xe.value,role:"option","aria-selected":!0===a?"true":"false",id:`${we.targetUid.value}_${r}`,onClick:()=>{toggleOption(t)}};return!0!==n&&(s.value===r&&(c.focused=!0),!0===i.platform.is.desktop&&(c.onMousemove=()=>{!0===u.value&&setOptionIndex(r)})),{index:r,opt:t,html:Pe.value(t),label:Ke.value(t),selected:c.active,focused:c.focused,toggleOption:toggleOption,setOptionIndex:setOptionIndex,itemProps:c}}))})),He=le((()=>void 0!==e.dropdownIcon?e.dropdownIcon:i.iconSet.arrow.dropdown)),Re=le((()=>!1===e.optionsCover&&!0!==e.outlined&&!0!==e.standout&&!0!==e.borderless&&!0!==e.rounded)),_e=le((()=>void 0!==e.optionsSelectedClass?e.optionsSelectedClass:void 0!==e.color?`text-${e.color}`:"")),Le=le((()=>getPropValueFn(e.optionValue,"value"))),Ke=le((()=>getPropValueFn(e.optionLabel,"label"))),$e=le((()=>getPropValueFn(e.optionDisable,"disable"))),Ne=le((()=>be.value.map(Le.value))),je=le((()=>{const e={onInput:onInput,onChange:W,onKeydown:onTargetKeydown,onKeyup:onTargetAutocomplete,onKeypress:onTargetKeypress,onFocus:selectInputText,onClick(e){!0===f&&q(e)}};return e.onCompositionstart=e.onCompositionupdate=e.onCompositionend=W,e}));function getEmittingOptionValue(l){return!0===e.emitValue?Le.value(l):l}function removeAtIndex(l){if(-1!==l&&l<be.value.length)if(!0===e.multiple){const o=e.modelValue.slice();t("remove",{index:l,value:o.splice(l,1)[0]}),t("update:modelValue",o)}else t("update:modelValue",null)}function removeAtIndexAndFocus(e){removeAtIndex(e),we.focus()}function add(l,o){const n=getEmittingOptionValue(l);if(!0!==e.multiple)return!0===e.fillInput&&updateInputValue(Ke.value(l),!0,!0),void t("update:modelValue",n);if(0===be.value.length)return t("add",{index:0,value:n}),void t("update:modelValue",!0===e.multiple?[n]:n);if(!0===o&&!0===isOptionSelected(l))return;if(void 0!==e.maxValues&&e.modelValue.length>=e.maxValues)return;const a=e.modelValue.slice();t("add",{index:a.length,value:n}),a.push(n),t("update:modelValue",a)}function toggleOption(l,o){if(!0!==we.editable.value||void 0===l||!0===$e.value(l))return;const n=Le.value(l);if(!0!==e.multiple)return!0!==o&&(updateInputValue(!0===e.fillInput?Ke.value(l):"",!0,!0),hidePopup()),k.value?.focus(),void(0!==be.value.length&&!0===M(Le.value(be.value[0]),n)||t("update:modelValue",!0===e.emitValue?n:l));if(!0===f&&!0!==d.value||we.focus(),selectInputText(),0===be.value.length){const o=!0===e.emitValue?n:l;return t("add",{index:0,value:o}),void t("update:modelValue",!0===e.multiple?[o]:o)}const a=e.modelValue.slice(),i=Ne.value.findIndex((e=>M(e,n)));if(-1!==i)t("remove",{index:i,value:a.splice(i,1)[0]});else{if(void 0!==e.maxValues&&a.length>=e.maxValues)return;const o=!0===e.emitValue?n:l;t("add",{index:a.length,value:o}),a.push(o)}t("update:modelValue",a)}function setOptionIndex(e){if(!0!==i.platform.is.desktop)return;const l=-1!==e&&e<X.value?e:-1;s.value!==l&&(s.value=l)}function moveOptionSelection(l=1,t){if(!0===u.value){let o=s.value;do{o=F(o+l,-1,X.value-1)}while(-1!==o&&o!==s.value&&!0===$e.value(e.options[o]));s.value!==o&&(setOptionIndex(o),ye(o),!0!==t&&!0===e.useInput&&!0===e.fillInput&&setInputValue(o>=0?Ke.value(e.options[o]):S,!0))}}function isOptionSelected(e){const l=Le.value(e);return void 0!==Ne.value.find((e=>M(e,l)))}function selectInputText(l){!0===e.useInput&&null!==k.value&&(void 0===l||k.value===l.target&&l.target.value===Te.value)&&k.value.select()}function onTargetKeyup(e){!0===B(e,27)&&!0===u.value&&(q(e),hidePopup(),resetInputValue()),t("keyup",e)}function onTargetAutocomplete(l){const{value:t}=l.target;if(void 0===l.keyCode)if(l.target.value="",null!==V&&(clearTimeout(V),V=null),null!==w&&(clearTimeout(w),w=null),resetInputValue(),"string"==typeof t&&0!==t.length){const l=t.toLocaleLowerCase(),findFn=t=>{const o=e.options.find((e=>String(t.value(e)).toLocaleLowerCase()===l));return void 0!==o&&(-1===be.value.indexOf(o)?toggleOption(o):hidePopup(),!0)},fillFn=e=>{!0!==findFn(Le)&&!0!==e&&!0!==findFn(Ke)&&filter(t,!0,(()=>fillFn(!0)))};fillFn()}else we.clearValue(l);else onTargetKeyup(l)}function onTargetKeypress(e){t("keypress",e)}function onTargetKeydown(l){if(t("keydown",l),!0===P(l))return;const o=0!==c.value.length&&(void 0!==e.newValueMode||void 0!==e.onNewValue),n=!0!==l.shiftKey&&!0!==e.disableTabSelection&&!0!==e.multiple&&(-1!==s.value||!0===o);if(27===l.keyCode)return void A(l);if(9===l.keyCode&&!1===n)return void closeMenu();if(void 0===l.target||l.target.id!==we.targetUid.value||!0!==we.editable.value)return;if(40===l.keyCode&&!0!==we.innerLoading.value&&!1===u.value)return x(l),void showPopup();if(8===l.keyCode&&(!0===e.useChips||!0===e.clearable)&&!0!==e.hideSelected&&0===c.value.length)return void(!0===e.multiple&&!0===Array.isArray(e.modelValue)?removeAtIndex(e.modelValue.length-1):!0!==e.multiple&&null!==e.modelValue&&t("update:modelValue",null));35!==l.keyCode&&36!==l.keyCode||"string"==typeof c.value&&0!==c.value.length||(x(l),s.value=-1,moveOptionSelection(36===l.keyCode?1:-1,e.multiple)),33!==l.keyCode&&34!==l.keyCode||void 0===G.value||(x(l),s.value=Math.max(-1,Math.min(X.value,s.value+(33===l.keyCode?-1:1)*G.value.view)),moveOptionSelection(33===l.keyCode?1:-1,e.multiple)),38!==l.keyCode&&40!==l.keyCode||(x(l),moveOptionSelection(38===l.keyCode?-1:1,e.multiple));const a=X.value;if((void 0===h||y<Date.now())&&(h=""),a>0&&!0!==e.useInput&&void 0!==l.key&&1===l.key.length&&!1===l.altKey&&!1===l.ctrlKey&&!1===l.metaKey&&(32!==l.keyCode||0!==h.length)){!0!==u.value&&showPopup(l);const t=l.key.toLocaleLowerCase(),o=1===h.length&&h[0]===t;y=Date.now()+1500,!1===o&&(x(l),h+=t);const n=new RegExp("^"+h.split("").map((e=>-1!==".*+?^${}()|[]\\".indexOf(e)?"\\"+e:e)).join(".*"),"i");let i=s.value;if(!0===o||i<0||!0!==n.test(Ke.value(e.options[i])))do{i=F(i+1,-1,a-1)}while(i!==s.value&&(!0===$e.value(e.options[i])||!0!==n.test(Ke.value(e.options[i]))));s.value!==i&&ne((()=>{setOptionIndex(i),ye(i),i>=0&&!0===e.useInput&&!0===e.fillInput&&setInputValue(Ke.value(e.options[i]),!0)}))}else if(13===l.keyCode||32===l.keyCode&&!0!==e.useInput&&""===h||9===l.keyCode&&!1!==n)if(9!==l.keyCode&&x(l),-1!==s.value&&s.value<a)toggleOption(e.options[s.value]);else{if(!0===o){const done=(l,t)=>{if(t){if(!0!==validateNewValueMode(t))return}else t=e.newValueMode;if(updateInputValue("",!0!==e.multiple,!0),null==l)return;("toggle"===t?toggleOption:add)(l,"add-unique"===t),!0!==e.multiple&&(k.value?.focus(),hidePopup())};if(void 0!==e.onNewValue?t("newValue",c.value,done):done(c.value),!0!==e.multiple)return}!0===u.value?closeMenu():!0!==we.innerLoading.value&&showPopup()}}function getVirtualScrollEl(){return!0===f?j.value:null!==$.value&&null!==$.value.contentEl?$.value.contentEl:void 0}function getAllOptions(){if(!0===ze.value)return void 0!==l["no-option"]?l["no-option"]({inputValue:c.value}):void 0;const e=void 0!==l.option?l.option:e=>re(_,{key:e.index,...e.itemProps},(()=>re(H,(()=>re(R,(()=>re("span",{[!0===e.html?"innerHTML":"textContent"]:e.label})))))));let t=Se("div",De.value.map(e));return void 0!==l["before-options"]&&(t=l["before-options"]().concat(t)),L(l["after-options"],t)}function onInput(l){null!==V&&(clearTimeout(V),V=null),null!==w&&(clearTimeout(w),w=null),l&&l.target&&!0===l.target.qComposing||(setInputValue(l.target.value||""),m=!0,S=c.value,!0===we.focused.value||!0===f&&!0!==d.value||we.focus(),void 0!==e.onFilter&&(V=setTimeout((()=>{V=null,filter(c.value)}),e.inputDebounce)))}function setInputValue(l,o){c.value!==l&&(c.value=l,!0===o||0===e.inputDebounce||"0"===e.inputDebounce?t("inputValue",l):w=setTimeout((()=>{w=null,t("inputValue",l)}),e.inputDebounce))}function updateInputValue(l,t,o){m=!0!==o,!0===e.useInput&&(setInputValue(l,!0),!0!==t&&!0===o||(S=l),!0!==t&&filter(l))}function filter(l,o,n){if(void 0===e.onFilter||!0!==o&&!0!==we.focused.value)return;!0===we.innerLoading.value?t("filterAbort"):(we.innerLoading.value=!0,p.value=!0),""!==l&&!0!==e.multiple&&0!==be.value.length&&!0!==m&&l===Ke.value(be.value[0])&&(l="");const i=setTimeout((()=>{!0===u.value&&(u.value=!1)}),10);null!==b&&clearTimeout(b),b=i,t("filter",l,((e,l)=>{!0!==o&&!0!==we.focused.value||b!==i||(clearTimeout(b),"function"==typeof e&&e(),p.value=!1,ne((()=>{we.innerLoading.value=!1,!0===we.editable.value&&(!0===o?!0===u.value&&hidePopup():!0===u.value?updateMenu(!0):u.value=!0),"function"==typeof l&&ne((()=>{l(a)})),"function"==typeof n&&ne((()=>{n(a)}))})))}),(()=>{!0===we.focused.value&&b===i&&(clearTimeout(b),we.innerLoading.value=!1,p.value=!1),!0===u.value&&(u.value=!1)}))}function onMenuBeforeHide(e){onControlPopupHide(e),closeMenu()}function onMenuShow(){Ve()}function onDialogFieldFocus(e){q(e),k.value?.focus(),d.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function onDialogFieldBlur(e){q(e),ne((()=>{d.value=!1}))}function onDialogBeforeHide(e){onControlPopupHide(e),null!==N.value&&N.value.__updateRefocusTarget(we.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),we.focused.value=!1}function onDialogHide(e){hidePopup(),!1===we.focused.value&&t("blur",e),resetInputValue()}function onDialogShow(){const e=document.activeElement;null!==e&&e.id===we.targetUid.value||null===k.value||k.value===e||k.value.focus(),Ve()}function closeMenu(){!0!==r.value&&(s.value=-1,!0===u.value&&(u.value=!1),!1===we.focused.value&&(null!==b&&(clearTimeout(b),b=null),!0===we.innerLoading.value&&(t("filterAbort"),we.innerLoading.value=!1,p.value=!1)))}function showPopup(t){!0===we.editable.value&&(!0===f?(we.onControlFocusin(t),r.value=!0,ne((()=>{we.focus()}))):we.focus(),void 0!==e.onFilter?filter(c.value):!0===ze.value&&void 0===l["no-option"]||(u.value=!0))}function hidePopup(){r.value=!1,closeMenu()}function resetInputValue(){!0===e.useInput&&updateInputValue(!0!==e.multiple&&!0===e.fillInput&&0!==be.value.length&&Ke.value(be.value[0])||"",!0,!0)}function updateMenu(l){let t=-1;if(!0===l){if(0!==be.value.length){const l=Le.value(be.value[0]);t=e.options.findIndex((e=>M(Le.value(e),l)))}J(t)}setOptionIndex(t)}function updateMenuPosition(){!1===r.value&&null!==$.value&&$.value.updatePosition()}function onControlPopupShow(e){void 0!==e&&q(e),t("popupShow",e),we.hasPopupOpen=!0,we.onControlFocusin(e)}function onControlPopupHide(e){void 0!==e&&q(e),t("popupHide",e),we.hasPopupOpen=!1,we.onControlFocusout(e)}function updatePreState(){f=(!0===i.platform.is.mobile||"dialog"===e.behavior)&&("menu"!==e.behavior&&(!0!==e.useInput||(void 0!==l["no-option"]||void 0!==e.onFilter||!1===ze.value))),g=!0===i.platform.is.ios&&!0===f&&!0===e.useInput?"fade":e.transitionShow}return te(be,(l=>{v=l,!0===e.useInput&&!0===e.fillInput&&!0!==e.multiple&&!0!==we.innerLoading.value&&(!0!==r.value&&!0!==u.value||!0!==Ie.value)&&(!0!==m&&resetInputValue(),!0!==r.value&&!0!==u.value||filter(""))}),{immediate:!0}),te((()=>e.fillInput),resetInputValue),te(u,updateMenu),te(X,(function(e,l){!0===u.value&&!1===we.innerLoading.value&&(J(-1,!0),ne((()=>{!0===u.value&&!1===we.innerLoading.value&&(e>l?J():updateMenu(!0))})))})),se(updatePreState),ce(updateMenuPosition),updatePreState(),oe((()=>{null!==V&&clearTimeout(V),null!==w&&clearTimeout(w)})),Object.assign(a,{showPopup:showPopup,hidePopup:hidePopup,removeAtIndex:removeAtIndex,add:add,toggleOption:toggleOption,getOptionIndex:()=>s.value,setOptionIndex:setOptionIndex,moveOptionSelection:moveOptionSelection,filter:filter,updateMenuPosition:updateMenuPosition,updateInputValue:updateInputValue,isOptionSelected:isOptionSelected,getEmittingOptionValue:getEmittingOptionValue,isOptionDisabled:(...e)=>!0===$e.value.apply(null,e),getOptionValue:(...e)=>Le.value.apply(null,e),getOptionLabel:(...e)=>Ke.value.apply(null,e)}),Object.assign(we,{innerValue:be,fieldClass:le((()=>`q-select q-field--auto-height q-select--with${!0!==e.useInput?"out":""}-input q-select--with${!0!==e.useChips?"out":""}-chips q-select--`+(!0===e.multiple?"multiple":"single"))),inputRef:C,targetRef:k,hasValue:Ie,showPopup:showPopup,floatingLabel:le((()=>!0!==e.hideSelected&&!0===Ie.value||"number"==typeof c.value||0!==c.value.length||z(e.displayValue))),getControlChild:()=>{if(!1!==we.editable.value&&(!0===r.value||!0!==ze.value||void 0!==l["no-option"]))return!0===f?function(){const t=[re(de,{class:`col-auto ${we.fieldClass.value}`,...Ce.value,for:we.targetUid.value,dark:xe.value,square:!0,loading:p.value,itemAligned:!1,filled:!0,stackLabel:0!==c.value.length,...we.splitAttrs.listeners.value,onFocus:onDialogFieldFocus,onBlur:onDialogFieldBlur},{...l,rawControl:()=>we.getControl(!0),before:void 0,after:void 0})];return!0===u.value&&t.push(re("div",{ref:j,class:Oe.value+" scroll",style:e.popupContentStyle,...qe.value,onClick:A,onScrollPassive:he},getAllOptions())),re(D,{ref:N,modelValue:r.value,position:!0===e.useInput?"top":void 0,transitionShow:g,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,noRouteDismiss:e.popupNoRouteDismiss,onBeforeShow:onControlPopupShow,onBeforeHide:onDialogBeforeHide,onHide:onDialogHide,onShow:onDialogShow},(()=>re("div",{class:"q-select__dialog"+(!0===xe.value?" q-select__dialog--dark q-dark":"")+(!0===d.value?" q-select__dialog--focused":"")},t)))}():re(pe,{ref:$,class:Oe.value,style:e.popupContentStyle,modelValue:u.value,fit:!0!==e.menuShrink,cover:!0===e.optionsCover&&!0!==ze.value&&!0!==e.useInput,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,dark:xe.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,noRouteDismiss:e.popupNoRouteDismiss,square:Re.value,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,separateClosePopup:!0,...qe.value,onScrollPassive:he,onBeforeShow:onControlPopupShow,onBeforeHide:onMenuBeforeHide,onShow:onMenuShow},getAllOptions);!0===we.hasPopupOpen&&(we.hasPopupOpen=!1)},controlEvents:{onFocusin(e){we.onControlFocusin(e)},onFocusout(e){we.onControlFocusout(e,(()=>{resetInputValue(),closeMenu()}))},onClick(e){if(A(e),!0!==f&&!0===u.value)return closeMenu(),void k.value?.focus();showPopup(e)}},getControl:t=>{const o=!0===e.hideSelected?[]:void 0!==l["selected-item"]?Be.value.map((e=>l["selected-item"](e))).slice():void 0!==l.selected?[].concat(l.selected()):!0===e.useChips?Be.value.map(((l,t)=>re(K,{key:"option-"+t,removable:!0===we.editable.value&&!0!==$e.value(l.opt),dense:!0,textColor:e.color,tabindex:Fe.value,onRemove(){l.removeAtIndex(t)}},(()=>re("span",{class:"ellipsis",[!0===l.html?"innerHTML":"textContent"]:Ke.value(l.opt)}))))):[re("span",{class:"ellipsis",[!0===Ae.value?"innerHTML":"textContent"]:Me.value})],n=!0===t||!0!==r.value||!0!==f;if(!0===e.useInput)o.push(function(l,t){const o=!0===t?{...Ee.value,...we.splitAttrs.attributes.value}:void 0,n={ref:!0===t?k:void 0,key:"i_t",class:ke.value,style:e.inputStyle,value:void 0!==c.value?c.value:"",type:"search",...o,id:!0===t?we.targetUid.value:void 0,maxlength:e.maxlength,autocomplete:e.autocomplete,"data-autofocus":!0===l||!0===e.autofocus||void 0,disabled:!0===e.disable,readonly:!0===e.readonly,...je.value};return!0!==l&&!0===f&&(!0===Array.isArray(n.class)?n.class=[...n.class,"no-pointer-events"]:n.class+=" no-pointer-events"),re("input",n)}(t,n));else if(!0===we.editable.value){const l=!0===n?Ee.value:void 0;o.push(re("input",{ref:!0===n?k:void 0,key:"d_t",class:"q-select__focus-target",id:!0===n?we.targetUid.value:void 0,value:Me.value,readonly:!0,"data-autofocus":!0===t||!0===e.autofocus||void 0,...l,onKeydown:onTargetKeydown,onKeyup:onTargetKeyup,onKeypress:onTargetKeypress})),!0===n&&"string"==typeof e.autocomplete&&0!==e.autocomplete.length&&o.push(re("input",{class:"q-select__autocomplete-input",autocomplete:e.autocomplete,tabindex:-1,onKeyup:onTargetAutocomplete}))}if(void 0!==U.value&&!0!==e.disable&&0!==Ne.value.length){const l=Ne.value.map((e=>re("option",{value:e,selected:!0})));o.push(re("select",{class:"hidden",name:U.value,multiple:e.multiple},l))}const a=!0===e.useInput||!0!==n?void 0:we.splitAttrs.attributes.value;return re("div",{class:"q-field__native row items-center",...a,...we.splitAttrs.listeners.value},o)},getInnerAppend:()=>!0!==e.loading&&!0!==p.value&&!0!==e.hideDropdownIcon?[re(E,{class:"q-select__dropdown-icon"+(!0===u.value?" rotate-180":""),name:He.value})]:null}),o(we)}});export{he as _};
//# sourceMappingURL=QSelect.mjs.map
