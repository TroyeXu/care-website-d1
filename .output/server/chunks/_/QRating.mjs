import{bd as e,be as a,n as t,e as o,az as n,aK as r,aC as s}from"../nitro/nitro.mjs";import{v as l,ah as c,ai as i,aj as u,ak as d,al as f,c as y,a6 as p,ad as v,ae as m,am as h,h as g,_,a8 as b,ab as D,r as A}from"../build/server.mjs";const w={trailing:!0};function debounce(e,a=25,t={}){if(t={...w,...t},!Number.isFinite(a))throw new TypeError("Expected `wait` to be a finite number");let o,n,r,s,l=[];const applyFn=(a,o)=>(r=async function(e,a,t){return await e.apply(a,t)}(e,a,o),r.finally((()=>{if(r=null,t.trailing&&s&&!n){const e=applyFn(a,s);return s=null,e}})),r);return function(...e){return r?(t.trailing&&(s=e),r):new Promise((r=>{const s=!n&&t.leading;clearTimeout(n),n=setTimeout((()=>{n=null;const a=t.leading?o:applyFn(this,e);for(const e of l)e(a);l=[]}),a),s?(o=applyFn(this,e),r(o)):l.push(r)}))}}function useAsyncData(...e){const a="string"==typeof e[e.length-1]?e.pop():void 0;(function(e,a){if("string"==typeof e)return!1;if("object"==typeof e&&null!==e)return!1;if("function"==typeof e&&"function"==typeof a)return!1;return!0})(e[0],e[1])&&e.unshift(a);let[t,o,n={}]=e;const r=l.computed((()=>l.toValue(t)));if("string"!=typeof r.value)throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if("function"!=typeof o)throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const s=i();n.server??=!0,n.default??=getDefault,n.getCachedData??=getDefaultCachedData,n.lazy??=!1,n.immediate??=!0,n.deep??=u.deep,n.dedupe??="cancel",n._functionName,s._asyncData[r.value];const c={cause:"initial",dedupe:n.dedupe};s._asyncData[r.value]?._init||(c.cachedData=n.getCachedData(r.value,s,{cause:"initial"}),s._asyncData[r.value]=function(e,a,t,o,n){e.payload._errors[a]??=void 0;const r=o.getCachedData!==getDefaultCachedData,s=t,c=o.deep?l.ref:l.shallowRef,i=void 0!==n,u=e.hook("app:data:refresh",(async e=>{e&&!e.includes(a)||await d.execute({cause:"refresh:hook"})})),d={data:c(i?n:o.default()),pending:l.computed((()=>"pending"===d.status.value)),error:l.toRef(e.payload._errors,a),status:l.shallowRef("idle"),execute:(...t)=>{const[n,r]=t,c=n&&void 0===r&&"object"==typeof n?n:{};if(e._asyncDataPromises[a]){if("defer"===(c.dedupe??o.dedupe))return e._asyncDataPromises[a];e._asyncDataPromises[a].cancelled=!0}{const t="cachedData"in c?c.cachedData:o.getCachedData(a,e,{cause:c.cause??"refresh:manual"});if(void 0!==t)return e.payload.data[a]=d.data.value=t,d.error.value=void 0,d.status.value="success",Promise.resolve(t)}d.status.value="pending";const i=new Promise(((a,t)=>{try{a(s(e))}catch(e){t(e)}})).then((async t=>{if(i.cancelled)return e._asyncDataPromises[a];let n=t;o.transform&&(n=await o.transform(t)),o.pick&&(n=function(e,a){const t={};for(const o of a)t[o]=e[o];return t}(n,o.pick)),e.payload.data[a]=n,d.data.value=n,d.error.value=void 0,d.status.value="success"})).catch((t=>{if(i.cancelled)return e._asyncDataPromises[a];d.error.value=f(t),d.data.value=l.unref(o.default()),d.status.value="error"})).finally((()=>{i.cancelled||delete e._asyncDataPromises[a]}));return e._asyncDataPromises[a]=i,e._asyncDataPromises[a]},_execute:debounce(((...e)=>d.execute(...e)),0,{leading:!0}),_default:o.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{u(),e._asyncData[a]?._init&&(e._asyncData[a]._init=!1),r||l.nextTick((()=>{e._asyncData[a]?._init||(clearNuxtDataByKey(e,a),d.execute=()=>Promise.resolve())}))}};return d}(s,r.value,o,n,c.cachedData));s._asyncData[r.value]._deps++;if(!1!==n.server&&s.payload.serverRendered&&n.immediate){const e=s._asyncData[r.value].execute(c);l.getCurrentInstance()?l.onServerPrefetch((()=>e)):s.hook("app:created",(async()=>{await e}))}const d={data:writableComputedRef((()=>s._asyncData[r.value]?.data)),pending:writableComputedRef((()=>s._asyncData[r.value]?.pending)),status:writableComputedRef((()=>s._asyncData[r.value]?.status)),error:writableComputedRef((()=>s._asyncData[r.value]?.error)),refresh:(...e)=>s._asyncData[r.value].execute(...e),execute:(...e)=>s._asyncData[r.value].execute(...e),clear:()=>clearNuxtDataByKey(s,r.value)},y=Promise.resolve(s._asyncDataPromises[r.value]).then((()=>d));return Object.assign(y,d),y}function writableComputedRef(e){return l.computed({get:()=>e()?.value,set(a){const t=e();t&&(t.value=a)}})}function clearNuxtDataByKey(e,a){a in e.payload.data&&(e.payload.data[a]=void 0),a in e.payload._errors&&(e.payload._errors[a]=void 0),e._asyncData[a]&&(e._asyncData[a].data.value=l.unref(e._asyncData[a]._default()),e._asyncData[a].error.value=void 0,e._asyncData[a].status.value="idle"),a in e._asyncDataPromises&&(e._asyncDataPromises[a]&&(e._asyncDataPromises[a].cancelled=!0),e._asyncDataPromises[a]=void 0)}const getDefault=()=>{},getDefaultCachedData=(e,a,t)=>a.isHydrating?a.payload.data[e]:"refresh:manual"!==t.cause&&"refresh:hook"!==t.cause?a.static.data[e]:void 0;function useFetch(a,t,o){const[n={},r]="string"==typeof t?[{},t]:[t,o],s=l.computed((()=>l.toValue(a))),i=l.computed((()=>l.toValue(n.key)||"$f"+e([r,"string"==typeof s.value?s.value:"",...generateOptionSegments(n)])));if(!n.baseURL&&"string"==typeof s.value&&"/"===s.value[0]&&"/"===s.value[1])throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:u,lazy:f,default:y,transform:p,pick:v,watch:m,immediate:h,getCachedData:g,deep:_,dedupe:b,...D}=n,A=l.reactive({...c,...D,cache:"boolean"==typeof n.cache?void 0:n.cache}),w={server:u,lazy:f,default:y,transform:p,pick:v,immediate:h,getCachedData:g,deep:_,dedupe:b,watch:!1===m?[]:[...m||[],A]};let x;return useAsyncData(!1===m?i.value:i,(()=>{x?.abort?.(new DOMException("Request aborted as another request to the same endpoint was initiated.","AbortError")),x="undefined"!=typeof AbortController?new AbortController:{};const e=l.toValue(n.timeout);let a;e&&(a=setTimeout((()=>x.abort(new DOMException("Request aborted due to timeout.","AbortError"))),e),x.signal.onabort=()=>clearTimeout(a));let t=n.$fetch||globalThis.$fetch;if(!n.$fetch){"string"==typeof s.value&&"/"===s.value[0]&&(!l.toValue(n.baseURL)||"/"===l.toValue(n.baseURL)[0])&&(t=d())}return t(s.value,{signal:x.signal,...A}).finally((()=>{clearTimeout(a)}))}),w)}function generateOptionSegments(t){const o=[l.toValue(t.method)?.toUpperCase()||"GET",l.toValue(t.baseURL)];for(const e of[t.params||t.query]){const a=l.toValue(e);if(!a)continue;const t={};for(const[e,o]of Object.entries(a))t[l.toValue(e)]=l.toValue(o);o.push(t)}if(t.body){const n=l.toValue(t.body);if(n)if(n instanceof ArrayBuffer)o.push(e(Object.fromEntries([...new Uint8Array(n).entries()].map((([e,a])=>[e,a.toString()])))));else if(n instanceof FormData){const a={};for(const e of n.entries()){const[t,o]=e;a[t]=o instanceof File?o.name:o}o.push(e(a))}else if(a(n))o.push(e(l.reactive(n)));else try{o.push(e(n))}catch{console.warn("[useFetch] Failed to hash body",n)}else o.push(e(n))}return o}const x=y({name:"QRating",props:{...v,...p,modelValue:{type:Number,required:!0},max:{type:[String,Number],default:5},icon:[String,Array],iconHalf:[String,Array],iconSelected:[String,Array],iconAriaLabel:[String,Array],color:[String,Array],colorHalf:[String,Array],colorSelected:[String,Array],noReset:Boolean,noDimming:Boolean,readonly:Boolean,disable:Boolean},emits:["update:modelValue"],setup(e,{slots:a,emit:l}){const{proxy:{$q:c}}=t(),i=m(e),u=h(e),d=b(u),f=o(0);let y={};const p=n((()=>!0!==e.readonly&&!0!==e.disable)),v=n((()=>`q-rating row inline items-center q-rating--${!0===p.value?"":"non-"}editable`+(!0===e.noDimming?" q-rating--no-dimming":"")+(!0===e.disable?" disabled":"")+(void 0!==e.color&&!1===Array.isArray(e.color)?` text-${e.color}`:""))),w=n((()=>{const a=!0===Array.isArray(e.icon)?e.icon.length:0,t=!0===Array.isArray(e.iconSelected)?e.iconSelected.length:0,o=!0===Array.isArray(e.iconHalf)?e.iconHalf.length:0,n=!0===Array.isArray(e.color)?e.color.length:0,r=!0===Array.isArray(e.colorSelected)?e.colorSelected.length:0,s=!0===Array.isArray(e.colorHalf)?e.colorHalf.length:0;return{iconLen:a,icon:a>0?e.icon[a-1]:e.icon,selIconLen:t,selIcon:t>0?e.iconSelected[t-1]:e.iconSelected,halfIconLen:o,halfIcon:o>0?e.iconHalf[t-1]:e.iconHalf,colorLen:n,color:n>0?e.color[n-1]:e.color,selColorLen:r,selColor:r>0?e.colorSelected[r-1]:e.colorSelected,halfColorLen:s,halfColor:s>0?e.colorHalf[s-1]:e.colorHalf}})),x=n((()=>{if("string"==typeof e.iconAriaLabel){const a=0!==e.iconAriaLabel.length?`${e.iconAriaLabel} `:"";return e=>`${a}${e}`}if(!0===Array.isArray(e.iconAriaLabel)){const a=e.iconAriaLabel.length;if(a>0)return t=>e.iconAriaLabel[Math.min(t,a)-1]}return(e,a)=>`${a} ${e}`})),C=n((()=>{const a=[],t=w.value,o=Math.ceil(e.modelValue),n=!0===p.value?0:null,r=void 0===e.iconHalf||o===e.modelValue?-1:o;for(let s=1;s<=e.max;s++){const l=0===f.value&&e.modelValue>=s||f.value>0&&f.value>=s,i=r===s&&f.value<s,u=f.value>0&&(!0===i?o:e.modelValue)>=s&&f.value<s,d=!0===i?s<=t.halfColorLen?e.colorHalf[s-1]:t.halfColor:void 0!==t.selColor&&!0===l?s<=t.selColorLen?e.colorSelected[s-1]:t.selColor:s<=t.colorLen?e.color[s-1]:t.color,y=(!0===i?s<=t.halfIconLen?e.iconHalf[s-1]:t.halfIcon:void 0===t.selIcon||!0!==l&&!0!==u?s<=t.iconLen?e.icon[s-1]:t.icon:s<=t.selIconLen?e.iconSelected[s-1]:t.selIcon)||c.iconSet.rating.icon;a.push({name:(!0===i?s<=t.halfIconLen?e.iconHalf[s-1]:t.halfIcon:void 0===t.selIcon||!0!==l&&!0!==u?s<=t.iconLen?e.icon[s-1]:t.icon:s<=t.selIconLen?e.iconSelected[s-1]:t.selIcon)||c.iconSet.rating.icon,attrs:{tabindex:n,role:"radio","aria-checked":e.modelValue===s?"true":"false","aria-label":x.value(s,y)},iconClass:"q-rating__icon"+(!0===l||!0===i?" q-rating__icon--active":"")+(!0===u?" q-rating__icon--exselected":"")+(f.value===s?" q-rating__icon--hovered":"")+(void 0!==d?` text-${d}`:"")})}return a})),L=n((()=>{const a={role:"radiogroup"};return!0===e.disable&&(a["aria-disabled"]="true"),!0===e.readonly&&(a["aria-readonly"]="true"),a}));function set(a){if(!0===p.value){const t=D(parseInt(a,10),1,parseInt(e.max,10)),o=!0!==e.noReset&&e.modelValue===t?0:t;o!==e.modelValue&&l("update:modelValue",o),f.value=0}}function setHoverValue(e){!0===p.value&&(f.value=e)}function resetMouseModel(){f.value=0}return r((()=>{y={}})),()=>{const t=[];return C.value.forEach((({iconClass:e,name:o,attrs:n},r)=>{const l=r+1;t.push(s("div",{key:l,ref:e=>{y[`rt${l}`]=e},class:"q-rating__icon-container flex flex-center",...n,onClick(){set(l)},onMouseover(){setHoverValue(l)},onMouseout:resetMouseModel,onFocus(){setHoverValue(l)},onBlur:resetMouseModel,onKeyup(e){!function(e,a){switch(e.keyCode){case 13:case 32:return set(a),A(e);case 37:case 40:return y["rt"+(a-1)]&&y["rt"+(a-1)].focus(),A(e);case 39:case 38:y[`rt${a+1}`]&&y[`rt${a+1}`].focus(),A(e)}}(e,l)}},g(a[`tip-${l}`],[s(_,{class:e,name:o})])))})),void 0!==e.name&&!0!==e.disable&&d(t,"push"),s("div",{class:v.value,style:i.value,...L.value},t)}}});export{x as _,useFetch as u};
//# sourceMappingURL=QRating.mjs.map
